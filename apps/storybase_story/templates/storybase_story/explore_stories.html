{% extends "base.html" %}

{% load i18n sekizai_tags menu_tags verbatim %}

{% block head_title %}{{ storybase_explore_title }}{{ block.super }}{% endblock %}

{% block extrahead %}
{% comment %}
Handlebars templates for rendering Backbone views.
{% endcomment %}

{% verbatim %}
<script type="text/x-handlebars-template" id="explorer-template">
<ul id="view-selector">
  <li><a class="tile-view" href="#">{{#gettext}}Tile View{{/gettext}}</a></li>
  <li><a class="list-view" href="#">{{#gettext}}List View{{/gettext}}</a></li>
  <li><a class="map-view" href="#">{{#gettext}}Map View{{/gettext}}</a></li>
</ul>
</script>

<script type="text/x-handlebars-template" id="filters-template">
<label for="topics">{{#gettext}}Topic{{/gettext}}</label>
<select name="topics">
  {{#topics}}
  <option value="{{id}}">{{name}}</option>
  {{/topics}}
</select>

<label for="places">{{#gettext}}Place{{/gettext}}</label>
<select name="places">
  {{#places}}
  <option value="{{id}}">{{name}}</option>
  {{/places}}
</select>

<label for="organizations">{{#gettext}}Organization{{/gettext}}</label>
<select name="organizations">
  {{#organizations}}
  <option value="{{id}}">{{name}}</option>
  {{/organizations}}
</select>

<label for="projects">{{#gettext}}Project{{/gettext}}</label>
  {{#projects}}
  <option value="{{id}}">{{name}}</option>
  {{/projects}}
<select name="projects"></select>

<label for="languages">{{#gettext}}Language{{/gettext}}</label>
<select name="languages">
  {{#languages}}
  <option value="{{id}}">{{name}}</option>
  {{/languages}}
</select>
</script>

<script type="text/x-handlebars-template" id="story-list-template">
</script>

{% endverbatim %}
{% endblock %}


{% block above_content %}
<ul id="breadcrumbs" class="row">{% show_breadcrumb %}</ul>
{% endblock %}

{% block col_center %}
{% addtoblock "css" %}<link rel="stylesheet" href="{{ STATIC_URL }}css/explorer.css">{% endaddtoblock %}

<div class="twelvecol last">
  <h2>{{ storybase_explore_title }}</h2>
  <div id="explorer"></div>
</div>

{% addtoblock "js" %}
<script type="text/javascript" src="{% url django.views.i18n.javascript_catalog %}"></script>
<script src="{{ STATIC_URL }}js/libs/Namespace.js"></script>
<script src="{{ STATIC_URL }}js/libs/underscore-min.js"></script>
<script src="{{ STATIC_URL }}js/libs/json2.js"></script>
<script src="{{ STATIC_URL }}js/libs/backbone-min.js"></script>
<script src="{{ STATIC_URL }}js/libs/handlebars-1.0.0.beta.6.js"></script>
<script src="{{ STATIC_URL }}js/models.js"></script>
<script src="{{ STATIC_URL }}js/utils.js"></script>
<script src="{{ STATIC_URL }}js/explorer/application.js"></script>
<script src="{{ STATIC_URL }}js/explorer/views.js"></script>
<script type="text/javascript">

$(document).ready(function() {
  var storyData = {{ stories_json }};
  var stories = new storybase.collections.Stories;
  stories.reset(storyData.objects);
  console.debug(stories);
  var explorer = new storybase.explorer.views.ExplorerApp({
    storyData: storyData
  });
  explorer.render();
});
</script>
{% endaddtoblock %}
{% endblock %}
